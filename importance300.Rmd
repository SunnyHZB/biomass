## 非参数相关
### Spearman
p<0.01筛出16个基因：  
X3676, X4199, X5925, X7124, X7450, X7983, X10884, X12070, X12310, X12841, X12907, X13752, X14087, X14146, X14279, X14351.

### Kendall
p<0.01为标准，也是16个基因，比Spearman少了X10884（p=0.02387），多了X14372（Spearman p=0.01171, Kendall p=0.007315）.

### Goodman-Kruskal
用tauxy（x为gene，y为height）作筛选标准，有240个gene跑出来结果都是tauxy=1，显然无法鉴别.  
用tauyx作为筛选标准，有240个基因都是tauyx=0.87.  
tauyx>=0.88筛出3个基因：  
X72, X273, X14980.

## 回归分析
### Theil非参数回归
p<5e-08筛选出20个基因：  
X13, X3676, X3783, X4199, X5925, X7124, X7450, X9661, X11164, X12310, X12841, X12907, X13752, X13941, X14087, X14099, X14146, X14279, X14351, X14372.

### Siegel稳健回归
p<1e-04筛选出11个基因：  
X13, X3676, X4199, X5925, X13648, X13941, X14087, X14146, X14254, X14351, X14372.

## 矩阵相关
### 预处理
```r
name=NULL
for (i in 1:300)
{
    median=median(gene[,i])
    if (median==0)  name=c(name,names(gene)[i])
}
print(name)
[1] "X3740"  "X14980"
```
可以看到X3740, X14980是中位数为0的基因。  
使用max()查找到相除值中最大值为8005.219，故将Inf替换为1x10^6。

### 筛选结果
这里有一个对之前方法的小修改，就是将mantel test的method="spearman"改为kendall。  
p<0.05筛选出18个基因：  
X2141, X2574, X8066, X8492, X9987, X10494, X10611, X10692, X10749, X10884, X11583, X12908, X13312, X13567, X13995, X14148, X14978, X15293.

## 机器学习
### 交叉验证
5折，训练集NMSE0=0.1389111，测试集NMSE=0.8860639.

### 变量重要性
```r
(imSD[1:15])
    X5925    X14146    X12907     X8078    X11722    X14351    X13752    X10324     X1018    X14879    X12988     X2574 
12.069331 11.676488 10.335830  9.808121  8.521183  8.357775  7.806965  7.702091  7.693755  7.347459  7.158967  6.976682 
    X5291     X3783    X14951 
 6.956672  6.886011  6.606174 

(imAccu[1:15])
   X14146     X5925     X8078    X12907    X14351    X12841    X13752    X12988     X5291     X1018     X2539    X10692 
190.75870 181.32348 149.98403 148.74420  90.98775  68.06536  55.28915  53.94735  50.70264  48.40562  43.74354  42.23314 
    X3121    X14879    X12070 
 32.43103  30.76071  26.96581 

(imMSE[1:15])
   X5925   X14146   X12907   X11722    X8078   X14351   X12988   X13752   X12841   X14879    X2574   X10324    X5291 
5874.806 5498.740 3791.604 3691.849 3649.398 3255.033 2914.737 2824.493 2811.747 2535.760 2399.311 2230.315 2215.577 
   X2539    X3121 
2163.574 2154.880 
```
共筛选出20个基因：  
X1018, X2539, X2574, X3121, X3783, X5291, X5925, X8078, X10324, X10692, X11722, X12070, X12841, X12907, X12988, X13752, X14146, X14351, X14879, X14951.

## 结果汇总
![Results](https://github.com/SunnyHZB/biomass/blob/master/300-candidates.jpg "结果汇总")  
共筛选出55个基因（104次），可能性较大的（3种方法及以上）15个.  
5种方法，3个：X5925, X14146, X14351.  
4种方法，6个：X3676, X4199, X12841, X12907, X13752, X14087.  
3种方法，6个：X7124, X7450, X12070, X12310, X14279, X14372.  
2种方法，7个：X13, X2574, X3783, X7983, X10692, X10884, X13941.  
1种方法，33个：X72, X273, X1018, X2141, X2539, X3121, X5291, X8066, X8078, X8492, X9661, X9987, X10324, X10494, X10611, X10749, X11164, X11583, X11722, X12908, X12988, X13312, X13567, X13648, X13995, X14099, X14148, X14254, X14879, X14951, X14978, X14980, X15293.

## 与之前结果的比较
1.两次结果中都是，Goodman-Kruskal与其他方法几乎没有重合，Matrix Correlation重合度也不高，剩下5种方法的结果重合得还比较好。  
2.这次是300个基因中筛出55个，之前是260个基因中筛出47个，比例上是差不多的。当然这是因为做Importance300时有意识参照了前面一次，所以可以看到除了Matrix Correlation，筛选的标准都提高了（e.g. 从p<0.05到p<0.01）。这应该是因为这300个基因已经经过一次筛选，是所有基因随机森林回归后重要性前300的基因的缘故。  
3.事实上，究竟该把标准定成什么、筛出多少个candidate才是大概“合适”，都是做的时候的一种“直观感受”，而且p-value这些本身也只是个统计指标，p=0.049和0.051之间不一定前者就和性状相关而后者无关。Fan 2015中用的是Matrix Correlation p<0.01，这个标准放到300个基因中能筛选出来9个；最后采用的p<0.05标准筛出18个是想着，这一步筛选可以先稍微多一些，等到后面做了annotation和functional categorisation，还肯定会有一些像上次那样没有功能信息的。其他方法也是按照每种方法15个左右基因去找的。  
4.Goodman-Kruskal这个方法感觉太奇怪，不太想用了。
